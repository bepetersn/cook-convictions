{% extends '_base.html' %}

{% block css %}
  {{ super() }}
  <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.3/leaflet.css">
  <link rel="stylesheet" type="text/css" href="css/simple.css" />
  <link rel="stylesheet" type="text/css" href="css/viz.css">
{% endblock css %}

{% block content %}

<div class="reveal">
  <div class="slides">
    {% for slide in slides %}
    <section id="{{ slide.id }}"{% if slide.class %} class="{{ slide.class }}"{% endif %}>  
      {{ render_file("slides/{0}.md".format(slide.id))|markdown }}
      <br/><hr><br/>
    </section>
    {% endfor %}
  </div>
</div>

{% endblock content %}

{% block library_scripts %}
{{ super() }}
<script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.6.0/underscore-min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.2/backbone-min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.3/leaflet.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/d3/3.4.11/d3.min.js"></script>
{% endblock %}

{% block scripts %}
<script src="js/convictions.js"></script>
<script src="js/convictions-charts.js"></script>
<script>
$(function() {
  // @todo: Move some of this initialization into the Convictions namespace.
  function createCommunityAreaMap(el) {
    var communityAreas = new Convictions.CommunityAreas();
    var communityAreasMap = new Convictions.CommunityAreaMapView({
      collection: communityAreas,
      el: el 
    });

    communityAreas.url = 'data/community_areas.json';

    communityAreas.fetch();
  }

  function createCategoryChart(el) {
    var chart = Convictions.charts.barChart();

    var data = [{"value": 4183, "label": "Violent Index Crimes"}, {"value": 10477, "label": "Property Index Crimes"}, {"value": 36275, "label": "Drug Crimes"}, {"value": 90526, "label": "Uncategorized"}];
    d3.select(el)
      .datum(data)
      .call(chart);
  }

  createCommunityAreaMap('#your-city-map');
  createCategoryChart('#charges-categories-chart');
});
</script>
{% endblock %}
